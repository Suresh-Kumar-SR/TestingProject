{% load static %}
<!DOCTYPE html>
<html> 
<head>
  <link rel="shortcut icon" href="{%  static 'favicon.ico' %}">
  <!--  CSS File     -->
  <link rel="stylesheet" type="text/css" href= {% static "/css/style.css" %}>
  <title>{% block title %}{% endblock %}</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"
  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog=="
  crossorigin="anonymous" />
  
  {% load bootstrap5 %}
  {% bootstrap_css %}
  {% bootstrap_javascript %}
 
</head>

<style>
  body{
    background-image: url("{% static 'images/background.jpg' %}");
    background-repeat: no-repeat;
    background-size: cover;
    background-color: white;
  }
 
p {
	font-size: 17px;
	align-items: center;
}
.box a {
	display: inline-block;
	background-color: #fff;
	padding: 15px;
	border-radius: 3px;
}
.modal {
	align-items: center;
	display: flex;
	justify-content: center;
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	right: 0;
	background: rgba(254, 126, 126, 0.7);
	transition: all 0.4s;
	visibility: hidden;
	opacity: 0;
}
.content {
	position: absolute;
	background: white;
	width: 400px;
	padding: 1em 2em;
	border-radius: 4px;
}
.modal:target {
	visibility: visible;
	opacity: 1;
}
.box-close {
	position: absolute;
	top: 0;
	right: 15px;
	color: #fe0606;
	text-decoration: none;
	font-size: 30px;
}

</style>
{% block content %}
<body>
  <nav class="navbar navbar-custom"> 
    <img  src= "{% static 'images/iit.png' %}"  >
    <a class="navbar-brand" href="#">  BridgeSCAN    
    </a> 
     
   <img src= "{% static 'images/cdac.png' %}" >
   </nav>

<figure class="figure"> <div class="position-absolute bottom-0 start-0">
  <img src="{% static 'images/emblem.png' %}"class="figure-img img-fluid rounded"  >
  
</figure>
<div class="position-absolute bottom-0 start-30 ">Project Funded by<br><strong>Ministry of Road Transport and Highways (MoRTH), Government of India
</strong></div>
                  
	
 <!-- LOGIN FORM -->	   
 <form action="{% url "BridgeSCAN:login" %}" method="POST">
	{% csrf_token %}
	
<div class="col-md-1 mx-auto p-0 sticky-md-bottom  ">
	<div class="card">	
<div class="login-box">
	<div class="login-snip">
		
		<input id="tab-1" type="radio" name="tab" class="sign-in" checked><label for="tab-1" class="tab">Login</label>
		<input id="tab-2" type="radio" name="tab" class="sign-up"><label for="tab-2" class="tab">Sign Up</label>
	
		
		<div class="login-space">
			<div class="login">
				<div class="group">
					<div>
						{% for messages in messages %}
						<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
							<symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16">
								<path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
							  </symbol>
							</svg>
						<div class="alert alert-danger alert-dismissible">
							<svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Danger:"><use xlink:href="#exclamation-triangle-fill"/></svg>
							
							<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
							<strong>Invalid User!</strong> Please check your Username and Password.
						  </div>

						
						{% endfor %}</div>
						<br><br>
												
					<input  type="text" class="input" data-type="text" placeholder="Enter your Username" name="username">
				</div>
				<div class="group">
					
					<input  type="password" class="input" data-type="password" placeholder="Enter your password" name="password">
				</div>
			
			</form>
				<div class="group">
					<input type="submit" class="button" value="Sign In">
				</div>
				
				<div class="hr"></div>
				<div class="foot"><label for="tab-1">
				<a href="#">Forgot Password?</a></label>
				
				</div>
			</div>
		</form>
			<!--    REGISTER FORM    -->
		<form action="{% url "BridgeSCAN:register" %}" method="POST">
				{% csrf_token %}
			<div class="sign-up-form">
				<div class="group">
					<input type="text" class="input" placeholder="Create your Username" name="username">
				</div>
				<div class="group">
					<input type="password" class="input" data-type="password" placeholder="Create your password" name="pass1">
				</div>
				<div class="group">
					<input type="password" class="input" data-type="password" placeholder="Repeat your password" name="pass2" >
				</div>
				<div class="group">
					<input type="text" class="input" placeholder="Enter your email address" name="email">
				</div>
				<div id="otp" class="inputs d-flex flex-row justify-content-center mt-2"> 
			
				<input type="button" value="Generate OTP" id="generate-otp-button">
				<input type="text" name="otp" placeholder="Enter OTP" id="otp-field"style="display:none;" >
				<input type="button" value="Verify OTP" id="verify-otp-button" style="display:none;">
				
				<button type="button" class="btn btn-outline-secondary">Cancel</button></div>
			<div class="d-grid gap-1 col-6 mx-auto">
			<button type="button" class="btn btn-success">Register</button></div>
			
				<div class="hr"></div>
				<div class="foot">
					<label for="tab-1">Already Member?</label>
				</div>
				
			</div>
			
				
		</form>
{% if retry_option %}
    <p>Passwords do not match. Please try again.</p>
{% endif %}

			
		</div>
	</div>
</div>  

{% endblock %}
<script>
	// JavaScript code to handle the button click events
	$(document).ready(function () {
		$("#generate-otp-button").click(function () {
			$.ajax({
				url: "{% url "BridgeSCAN:register" %}",  // Replace 'generate_otp' with your URL pattern name for the OTP generation view
				method: "POST",
				data: $("#register").serialize(),
				success: function (response) {
					alert("An OTP has been sent to your email address.");
					// Show OTP field and verify button
					$("#otp-field").show();
					$("#verify-otp-button").show();
				},
				error: function (error) {
					alert("Failed to generate OTP. Please try again later.");
				}
			});
		});

		$("#verify-otp-button").click(function () {
			$.ajax({
				url: "{% url "BridgeSCAN:register" %}",  
				method: "POST",
				data: {
					'otp': $("#otp-field").val(),
					'csrfmiddlewaretoken': $('input[name="csrfmiddlewaretoken"]').val()
				},
				success: function (response) {
					alert("OTP verification successful!");
					
				},
				error: function (error) {
					alert("OTP verification failed. Please enter a valid OTP.");
				}
			});
		});
	});
</script>
					
</body>
</html>